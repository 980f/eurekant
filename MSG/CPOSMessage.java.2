package PaySTM;

import java.lang.*;
import java.util.*;

import JUtils.*;

/*
String sTestIn = "Field1=Value1;Field2=Value2;";
Hashtable oHashtable = new Hashtable();
long lInnerResult = JUtils.LRStringToHashTable(sTestIn,oHashtable);
System.out.println(oHashtable.toString());
StringBuffer sTestOut = new StringBuffer();
lInnerResult = JUtils.HashtableToLRString(oHashtable, sTestOut);
System.out.println(sTestOut.toString());
*/


public class CPOSMessage  //wrapper for message implementation
{
  private boolean l_bLogAll = false;
  
  private Hashtable m_oHashtable;
  
  public boolean Initialize()
  {
    boolean bResult = false;
    
    if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", Initialize(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      long lInnerResult = JUtils.RESULT_FAILURE;
      
      m_oHashtable = new Hashtable();
      //End method body
      
      bResult = true;
    }
    catch(Throwable oThrowable)
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", Initialize(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", Initialize(), Thread = " + Thread.currentThread() + ", Finally, bResult = " + bResult);}
  
      return bResult;
    } 
  }

  
  public boolean Initialize(String sMessage)
  {
    boolean bResult = false;
    
    if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", Initialize(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      long lInnerResult = JUtils.RESULT_FAILURE;
      
      m_oHashtable = new Hashtable();
      
      lInnerResult = LRStringToHashTable(sMessage,m_oHashtable);
      if (JUtils.RESULT_SUCCESS != lInnerResult)
      {
        break GiveUp;
      }
      //End method body
      
      bResult = true;
    }
    catch(Throwable oThrowable)
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", Initialize(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", Initialize(), Thread = " + Thread.currentThread() + ", Finally, bResult = " + bResult);}
  
      return bResult;
    } 
  }
  

  public long GetValue(StringBuffer sbFieldValue, String sFieldName)
  {
    long lResult = JUtils.RESULT_FAILURE;
    
    if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", GetValue(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      Object o = m_oHashtable.get(sFieldName);
      
      if (null == o)
      {break GiveUp;}
      
      sbFieldValue.append((String)o);  
      //End method body
      
      lResult = JUtils.RESULT_SUCCESS;
    }
    catch(Throwable oThrowable)
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", GetValue(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", GetValue(), Thread = " + Thread.currentThread() + ", Finally, lResult = " + lResult);}
  
      return lResult;
    } 
  }
  
  
  public long SetValue(String sFieldName, String sFieldValue)
  {
    long lResult = JUtils.RESULT_FAILURE;
    
    if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", SetValue(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      m_oHashtable.put(sFieldName, sFieldValue);
      //End method body
      
      lResult = JUtils.RESULT_SUCCESS;
    }
    catch(Throwable oThrowable)
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", SetValue(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if (((true == JUtils.g_bLogAll) || (true == l_bLogAll)) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + this.getClass().getName() + ", SetValue(), Thread = " + Thread.currentThread() + ", Finally, lResult = " + lResult);}
  
      return lResult;
    } 
  }
  
  
  public long GetMessageTransmissionString(StringBuffer sbFullString)
  {
    long lResult = JUtils.RESULT_FAILURE;
    
    if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", GetMessageTransmissionString(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      long lInnerResult = HashtableToLRString(m_oHashtable, sbFullString);
      if (JUtils.RESULT_SUCCESS != lInnerResult)
      {
        break GiveUp;
      }
      //End method body
      
      lResult = JUtils.RESULT_SUCCESS;
    }
    catch(Throwable oThrowable)
    {
      if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", GetMessageTransmissionString(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", GetMessageTransmissionString(), Thread = " + Thread.currentThread() + ", Finally, lResult = " + lResult);}
  
      return lResult;
    } 
  }
  
  
  private long LRStringToHashTable(String input_message, Hashtable htable_name)
  {
    long lResult = JUtils.RESULT_FAILURE;
    
    if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", LRStringToHashtable(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      int token_count, lindex;
      String input_string, temp_string, key_entry, contents_entry;
      htable_name.clear();
      input_string = input_message;
      token_count = 0;
      StringTokenizer tokens = new StringTokenizer( input_string );
      while ( tokens.hasMoreTokens()                             ) 
      {
        token_count++;
        temp_string = tokens.nextToken( ";" ) ;  //TBD: Use CISOMessage.m_ISO_FieldSeparator
        lindex = temp_string.indexOf( (int) '=' );  //TBD: Use CISOMessage.m_ISO_LRSeparator
        key_entry = temp_string.substring( 0, lindex );
        contents_entry = temp_string.substring( lindex + 1 ) ;
        Object val = htable_name.put( key_entry, contents_entry );
      }
      //End method body
      
      lResult = JUtils.RESULT_SUCCESS;
    }
    catch(Throwable oThrowable)
    {
      if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", LRStringToHashtable(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", LRStringToHashtable(), Thread = " + Thread.currentThread() + ", Finally, lResult = " + lResult);}
  
      return lResult;
    } 
  }
  
  
  private long HashtableToLRString(Hashtable htable_name, StringBuffer output_message)
  {
    long lResult = JUtils.RESULT_FAILURE;
    
    if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", HashtableToLRString(), Thread = " + Thread.currentThread() + ", Entry");}
    
    GiveUp:try
    {
      //Begin method body
      String temp_keyx, tempstringx;
      //output_message = "";
      for ( Enumeration enum = htable_name.keys(); enum.hasMoreElements(); ) 
      {
        temp_keyx = enum.nextElement().toString() ;
        Object o_tempstringx = htable_name.get( temp_keyx );
        tempstringx = o_tempstringx.toString();
        output_message.append(temp_keyx + "=" + tempstringx + ";");  //TBD: Use CISOMessage constants
      }
      //End method body
      
      lResult = JUtils.RESULT_SUCCESS;
    }
    catch(Throwable oThrowable)
    {
      if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", HashtableToLRString(), Thread = " + Thread.currentThread() + ", ERROR = " + oThrowable.toString());}
      oThrowable.printStackTrace(System.out);
    }
    
    finally
    {
      if ((true == JUtils.g_bLogAll) && (null != JUtils.g_oJUtils)) {JUtils.g_oJUtils.AddLogEntry((new Date()).toString() + ", " + ", HashtableToLRString(), Thread = " + Thread.currentThread() + ", Finally, lResult = " + lResult);}
  
      return lResult;
    } 
  }
}